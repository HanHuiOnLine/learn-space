<!DOCTYPE html>
<html>
<head>
	<title>小明的悲伤故事</title>
</head>
<body>

</body>
<script type="text/javascript">
	/*
		在四月一个晴朗的早晨，小明遇见了他的百分百女孩，我们暂且称呼小明的女神为
		A。两天之后，小明决定给 A送一束花来表白。刚好小明打听到 A和他有一个共同的朋
		友 B，于是内向的小明决定让 B来代替自己完成送花这件事情。
		虽然小明的故事必然以悲剧收场，因为追 MM 更好的方式是送一辆宝马。不管怎样，我们
		还是先用代码来描述一下小明追女神的过程：

		假设当 A 在心情好的时候收到花，小明表白成功的几率有
		60%，而当 A在心情差的时候收到花，小明表白的成功率无限趋近于 0。

		小明跟 A 刚刚认识两天，还无法辨别 A 什么时候心情好。如果不合时宜地把花送给 A，花
		被直接扔掉的可能性很大，这束花可是小明吃了 7天泡面换来的。

		但是 A 的朋友 B 却很了解 A，所以小明只管把花交给 B，B 会监听 A 的心情变化，然后选
		择 A心情好的时候把花转交给 A，代码如下：
	*/
	var Flower = function () {};
	var xiaoming = {
		sendFlower: function (target) {
			var flower = new Flower();
			target.receiveFlower(flower);
		}
	}
	var B = {
		receiveFlower: function (flower) {
			A.listenGoodMood(function () {//监听A的好心情
				A.receiveFlower(flower);	
			})
		}
	}
	var A = {
		receiveFlower: function (flower) {
			console.log('收到花'+flower);
		}，
		listenGoodMood: function (fn) {
			setTimeout(function () {//假设十秒之后心情变好
				fn();
			},10000)
		}
	};
	xiaoming.sendFlower(B);

	/*
		虽然这只是个虚拟的例子，但我们可以从中找到两种代理模式的身影。代理 B 可以帮助 A
		过滤掉一些请求，比如送花的人中年龄太大的或者没有宝马的，这种请求就可以直接在代理 B
		处被拒绝掉。这种代理叫作保护代理。A 和 B 一个充当白脸，一个充当黑脸。白脸 A 继续保持
		良好的女神形象，不希望直接拒绝任何人，于是找了黑脸 B来控制对 A的访问。
	*/
</script>
</html>